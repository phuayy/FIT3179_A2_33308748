{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 500,
  "height": 320,
  "background": "#111823",
  "data": {
    "url": "https://raw.githubusercontent.com/phuayy/FIT3179_A2_33308748/main/data/team_avg_stats.csv"
  },
  "params": [
    {
      "name": "TeamASelection",
      "value": "NRG",
      "bind": {
        "input": "select",
        "name": "Select Team A: ",
        "options": [
          null, "BLG", "DRG", "DRX", "EDG", "FNC", "FUT", "G2", "GEN", "GX", "KC", "LEV", "MIBR", "NRG", "PRX", "RRQ", "SEN", "T1", "TH", "TL", "VIT", "XLG"
        ]
      }
    },
    {
      "name": "TeamBSelection",
      "value": "FNC",
      "bind": {
        "input": "select",
        "name": "Select Team B: ",
        "options": [
          null, "BLG", "DRG", "DRX", "EDG", "FNC", "FUT", "G2", "GEN", "GX", "KC", "LEV", "MIBR", "NRG", "PRX", "RRQ", "SEN", "T1", "TH", "TL", "VIT", "XLG"
        ]
      }
    }
  ],
  "transform": [
    {
      "calculate": "toNumber(replace(datum.stat_value, /[,%]/g, ''))",
      "as": "stat_value_num"
    },
    {
      "filter": {
        "field": "stat_name",
        "oneOf": ["acs", "adr", "kast", "hs_percent", "kd_ratio", "kpr"]
      }
    },
    {
      "filter": "TeamASelection !== null && TeamBSelection !== null"
    },
    {
      "filter": "datum.team === TeamASelection || datum.team === TeamBSelection"
    },
    {
      "calculate": "datum.team === TeamASelection ? -datum.stat_value_num : datum.stat_value_num",
      "as": "plot_value"
    }
  ],
  "title": {
    "text": "Team vs Team Stat Comparison",
    "anchor": "middle",
    "color": "white"
  },
  "layer": [
    {
      "mark": "rule",
      "encoding": {
        "x": {"datum": 0},
        "color": {"value": "#334155"},
        "size": {"value": 1}
      }
    },
    {
      "mark": "bar",
      "encoding": {
        "y": {
          "field": "stat_name",
          "type": "nominal",
          "axis": null,
          "scale": {
            "domain": ["acs", "adr", "kpr", "kd_ratio", "kast", "hs_percent"]
          }
        },
        "x": {
          "field": "plot_value",
          "type": "quantitative",
          "title": "Average Stat Value",
          "axis": {
            "labelColor": "white",
            "titleColor": "white",
            "labelExpr": "format(abs(datum.value), '')"
          }
        },
        "color": {
          "field": "team",
          "type": "nominal",
          "legend": {"title": "Team", "labelColor": "white", "titleColor": "white"}
        },
        "tooltip": [
          {"field": "team", "type": "nominal", "title": "Team"},
          {"field": "stat_name", "type": "nominal", "title": "Stat"},
          {
            "field": "stat_value_num",
            "type": "quantitative",
            "title": "Value",
            "format": ".2f"
          }
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "baseline": "middle",
        "fill": "white"
      },
      "encoding": {
        "y": {
          "field": "stat_name",
          "type": "nominal",
          "scale": {
            "domain": ["acs", "adr", "kpr", "kd_ratio", "kast", "hs_percent"]
          }
        },
        "x": {"field": "plot_value", "type": "quantitative"},
        "text": {
          "field": "stat_value_num",
          "type": "quantitative",
          "format": ".2f"
        },
        "align": {
          "condition": {"test": "datum.plot_value < 0", "value": "right"},
          "value": "left"
        },
        "dx": {
          "condition": {"test": "datum.plot_value < 0", "value": -5},
          "value": 5
        }
      }
    },
    {
      "mark": {
        "type": "text",
        "baseline": "middle",
        "fontWeight": "bold",
        "fill": "#e2e8f0"
      },
      "encoding": {
        "x": {"datum": 0},
        "y": {
          "field": "stat_name",
          "type": "nominal",
          "scale": {
            "domain": ["acs", "adr", "kpr", "kd_ratio", "kast", "hs_percent"]
          }
        },
        "text": {"field": "stat_name"}
      }
    }
  ],
  "config": {
    "view": {"stroke": null},
    "axis": {"gridColor": "#334155"}
  }
}